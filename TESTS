This file gives information on the tests that were made during the
Automake migration.

Environment
-----------
Arch Linux x64 with:
  - Autoconf 2.69
  - Automake 1.14.1
  - GNU Make 4.0

Current status
--------------
  - Gnulib integrated
  - Minimum Automake support
  - Build src/libs/*

Tests
-----

1. Generation of build system files

./bootstrap

Generated the following files and directories:
  INSTALL
  Makefile.in
  aclocal.m4
  autom4te.cache/
  build-aux/
  configure
  gnulib_m4/
  lib/
  src/include/config.hin

2. Build of various targets

Tests done in 2 configurations:

  - Out-of source build mode

    mkdir build
    cd build
    ../configure

  - In source build:
    ../configure

2.1 make

Following files are generated:

  - src/include/config.h
  - lib/libgnu.a
  - libbib.a
  - libdriver.a
  - libgroff.a, version.cpp and extra files (charset.alias,
    ref-add.sed, ref-del.sed)
  - libxutils.a

In order to check and improve the dependencies, the following targets
were built from a clean environment:
  - make lib/libgnu.a
  - make libbib.a
  - make libdriver.a
  - make libgroff.a
  - make libxutil.a

2.2 make clean

The following files remains (this is expected):
  - Makefile
  - config.status
  - config.log
  - src/include/config.h
  - src/include/stamp-h1
  - .deps directories and .dirstamp files

2.3 make mostlyclean

  Like 'make clean', but the following files also remain (expected):
  - lib*.a
  - libgroff.a's charset.alias, ref-add.sed, ref-del.sed, and
    version.cpp.
  - gnulib's charset.alias, ref-add.sed, ref-del.sed and configmake.h

2.4 make distclean

  Like 'make clean', but the following files are also cleaned:
  - Makefile
  - config.status
  - config.log
  - src/include/config.h
  - src/include/stamp-h1
  - .deps directories and .dirstamp files

  In a out-of-source build, nothing remains in the build directory
  expect empty directories.

  The files generated by bootstrap and needed by the configure script
  are untouched:
  INSTALL
  Makefile.in
  aclocal.m4
  build-aux/
  configure
  gnulib_m4/
  lib/
  src/include/config.hin

2.5 make maintainer-clean

  Like 'make distclean'

2.6 make install

  mkdir -p ~/tmp/automake
  make install DESTDIR=~/tmp/automake

  - If file charset.alias is always present in
    $(DESTDIR)/usr/local/lib, make install update it by adding 'groff'
    to the list of programs using it. Otherwise nothing is installed.

2.7 make uninstall

  - Removes $(DESTDIR)/usr/local/lib/charset.alias if exists

2.8 make dist

  groff-1.22.2.tar.gz is generated. src/libs .c, .cpp and .am files
  are present.

  - Files/directories that are not distributed on purpose:
    .gitignore
    .gitmodules
    bootstrap
    bootstrap.conf
    gnulib/
    README.git
    TESTS

  - Missing files/directories (TODO):
    arch/
    contrib/
    doc/
    font/
    man/
    src/include (except config.hin and include.am)
    tmac
    test-groff.in

  - Files/directories not present in the git tree that are
    distributed:
    build-aux/
    gnulib_m4/
    lib/
    src/include/config.hin
    INSTALL
    Makefile.in
    aclocal.m4
    configure   

2.9 make distcheck
  
  - configure fails: src/roff/groff/groff.cpp is missing (passed to
    AC_CONFIG_SRCDIR macro)

Notes
-----

  - Gnulib: some files of src/libs/libgroff could be replaced by their
    gnulib equivalent
